{% extends "base.html" %}

{% block js %}
<script type="text/javascript" src="/site_media/js/mochikit/MochiKit/MochiKit.js"></script>
<script type="text/javascript" src="/site_media/js/mochikit/MochiKit/DragAndDrop.js"></script>
<script type="text/javascript" src="/site_media/js/moveteams.js"></script>
{% endblock %}

{% block css %}
{{formset.media}}
{% endblock %}

{% block breadcrumbs %}
{% endblock %}


{% block content %}
  {%if user.is_anonymous%}
  <div class="textblock">
    <h1>Welcome!</h1>
    <p>
      <a href="{%url djangowind.views.login %}?next=/">LOGIN!</a>
    </p>
    Welcome to <em>Ground | Work</em>, an online conflict simulation. This program is designed as an online learning tool to accompany and enhance the material discussed in this course on environment and security. The tool should be used as a method to apply both your theoretical understanding of the material, review practical program design concepts and options relevant to this case study and identified in the course readings, and encourage negotiating and team building in cross-disciplinary teams. It is also intended to help you reflect on three main themes that run through the course.
</p><p>
<ol>
<li>The impact of conflict on the environment (with a focus on post-conflict scenarios)</li>
<li>The impact of natural resources on conflict (with a focus on active conflict scenarios)</li>
<li>How natural resources can contribute to conflict prevention</li>
</ol>
</p><p>
The simulation occurs based upon the fictional narrative of a country called Nimpala. Although the scenario is fabricated, it is derived from several real world case studies and framed around the key themes and topics discussed throughout the semester.
</p><p>
The simulation will be primarily a group activity. Except for the initial conflict analysis and the final writing assignment, you will be divided into teams to complete the rest of the assignments. These groups will represent a UN Country Team responsible for guiding Nimpala's post-conflict needs assessments and help guide the donor distribution of reconstruction and restoration funding.
</p><p>
This simulation is not a predictive model and there are no right or wrong decisions. Instead, ground | work is meant to provide a forum to discuss and debate assessment, prioritization, and sequencing of post-conflict aid, specifically as it relates to natural resources and the environment.
</p><p>
Good luck and please don't hesitate to ask for assistance throughout the process. 
</p>
  </div>
  {%else%}
  <div class="textblock">
  <h1>{{user.get_full_name|default:user.username}}'s Dashboard</h1>
  
  {%if is_faculty%}
  <h2>Team Details</h2>
  <a href="{%url team-admin %}">Team Administration and Assignment</a>
  {%endif%}

   {%if team%}
 <div id="alertbox">
 <h2>Your Team</h2>
  
  <ul>
    {%for member in team.group.user_set.all %}
    <li>{{member.get_full_name|default:member.username}}</li>
    {%endfor%}
  </ul>
  </div>
  {%endif%}

  <p>
  {%for survey in todo %}
  <h2>Welcome!</h2>
  <b> Please fill out your <a href="{%url survey-detail survey.slug %}">{{survey.title}}</a></b>
  {%endfor%}
 
  </p>
 <h2>Assignments</h2>
  <!--fake table-->

  {%if is_faculty%}
  
  <ul>
    <lh><h3>Instructor Information</h3></lh>
    <li>Teams can only edit an assignment if it is both marked open and their team-marker is on that assignment.  Therefore, only one at a time.  Colored team-markers indicate that the team has submitted that assignment for instructor review.</li>
    <li>If the next assignment is open, teams can auto-advance by submitting their current assignment.</li>
    <li>The due date auto-closes the assignment.</li>
    <li>You can manually move a team to a particular assignment by dragging the markers.
        <br /><br />
	<p>For instance, if you want to give one team an extension on an assignment that is now closed, then:
	<ol>
	  <li>Move the other team-markers to the next assignment. (Which you can leave closed, if you don't want anyone to start that one, yet.</li>
	  <li>Leave the exception-team on the extension-assignment (or move it back, manually to that assignment).</li>
	  <li>Re-open the extension-assignment.  Since the other teams are on a later assignment, they will not be able to edit it.</li>
	</ol>
	</p>
    </li>
  </ul>

     <form method="POST">
     <input type="submit" value="Save" />
       {{ formset.management_form }}
  {%endif%}
  <table>
    <thead>
      <tr>
	<th>Activity Name</th>
	<th>Type</th>
	<th>Due Date</th>
	<th>Status</th>
      </tr>
    </thead>
    <tbody>
      {%for assn in assignments %}
      {%if not assn.hidden or is_faculty %}
      <tr 
	  {%if assn.current %}
	  class="current"
	  {%endif%}
	  >
	<td>
	    {{assn.data.name}}
	    {%if team %}
	    <br />
	    <a href="{%url assignment-page assn.data.id %}">
	      {%if assn.current %}
	      Open
	      {%else%}
	      Review
	      {%endif%}
	    </a>
	    {%endif%}
	    {%if is_faculty%}
	       {%with assn.data.any_submission as first_submission %}
	          {%if first_submission %}
		  <br />
		  <a href="{%url assignment-page assignment_id=assn.data.id,faculty_view="/instructor/",user_id=first_submission.author.id %}">Review Submissions</a>
		  {%endif%}
	       {%endwith%}
	       Open: {{assn.form.visible_fields.1}}
	    {%endif%}
	</td>
	<td>{{assn.data.individual|yesno:"Individual,Group"}}
	</td>
	<td style="width:15em;">
	  {%if is_faculty%}
	    {% for hidden in assn.form.hidden_fields %}
	       {{ hidden }}
	    {% endfor %}

	    {{assn.form.visible_fields.0}}
          {%else%}
            {{assn.data.close_date|date:"l, n/j/y, P"}}
	  {%endif%}
	</td>
	<td class="teamstatus" data-assn="{{assn.data.id}}">
	  {%for ateam in assn.teams %}
	    {%ifequal team ateam.data %}
	    <!--STUDENT-->
	      {%if ateam.sub %}
	         {%if ateam.sub.0.published %}
		    Submitted
		    {{ateam.sub.0.modified|date:"n/j/y, P"}}
		 {%else%}
		    Draft
		 {%endif%}
	      {%endif%}
	    {%endifequal%}
	    {%if is_faculty %}
	      {%ifequal ateam.data.state.turn ateam.turn %}
	        <div id="teammarker-{{ateam.data.id}}" data-team="{{ateam.data.id}}" class="teamoptions markerparent"><div data-current="{{assn.data.id}}"
		   {%if ateam.sub.0.published %}
		   class="team-marker on" title="published"
		   {%else%}
		   class="team-marker"
		   {%endif%}
		  >{{ateam.data.index}}</div></div>
	      {%endifequal%}
	      <div id="teamstatus-{{ateam.data.id}}-{{assn.data.id}}" data-status="{{ateam.sub.0.published}}"></div>
	    {%endif%}
	  {%endfor%}
	</td>
      </tr>
      {%endif%}
      {%endfor%}
    </tbody>
  </table>
  {%if is_faculty%}
  <input type="submit" value="Save" />
  </form>  
  {%endif%}

<!--end real table  -->
  
  
  
  
  
  
  </div>

  {%endif%}

  {% endblock %}
